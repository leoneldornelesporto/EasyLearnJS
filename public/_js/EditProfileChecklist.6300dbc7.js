"use strict";function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var EditProfileChecklist=function(){function e(){_classCallCheck(this,e),this.checklist=[],this.checklistBox=document.getElementById("profile_checklist-box"),this.checklistTitle=document.getElementById("profile_checklist-title"),this.checklistItensBox=document.getElementById("checklist"),this.userPhoto=document.getElementById("userPhoto"),this.ignoredExtraInfos=["TWITTER","PORTFOLIO"],this.updateChecklistInfo(),this.updateCompletedPercentage(),this.setupListeners()}return _createClass(e,[{key:"updateChecklistInfo",value:function(){var n=this,e=document.getElementsByClassName("checklist-field"),o=this.getIgnoredOccupationFieldsIds();this.userPhoto&&(r=this.userPhoto.dataset.label,this.checklist.push({label:r,isCompleted:!1,itemId:"checklist-photo"}));var i,t=_createForOfIteratorHelper(e);try{for(t.s();!(i=t.n()).done;)!function(){var e,t=i.value,r=n.ignoredExtraInfos.some(function(e){return t.classList.contains(e)});o.includes(t.id)||r||(e=document.querySelector("label[for='"+t.id+"']").textContent.trim().split("\n")[0],r=!!t.value.trim(),n.checklist.push({label:e,isCompleted:r,itemId:null}))}()}catch(e){t.e(e)}finally{t.f()}var r=document.getElementById("interest-title");r&&(e=r.textContent,r=0<document.querySelectorAll("input[name='interestedCategories']:checked").length,this.checklist.push({label:e,isCompleted:r})),this.checklist.forEach(function(e){return n.addItemToChecklist(e)}),this.updateUserPhotoCompletion()}},{key:"hasCustomGravatarImage",value:function(e){return(e=new URL(e)).searchParams.set("d","404"),fetch(e).then(function(e){return e.ok})}},{key:"addItemToChecklist",value:function(e){var t=document.createElement("li");t.textContent=e.label,e.isCompleted&&t.classList.add("completed"),e.itemId&&(t.id=e.itemId),this.checklistItensBox.appendChild(t)}},{key:"updateCompletedPercentage",value:function(){var e=this.checklist.filter(function(e){return e.isCompleted}).length/this.checklist.length*100,t=document.getElementById("profile_percentage-completed"),r=document.getElementById("profile_percentage-completed-marker");t.style.width=e+"%",r.style.left="max("+e+"% - 42px, -3px)",t=e<33.3?"tooltip-beginner":66.6<e?"tooltip-advanced":"tooltip-intermediate",100==e&&(r.classList.add("profile-completed"),t="tooltip-completed"),r.classList.add(t)}},{key:"getIgnoredOccupationFieldsIds",value:function(){var e=document.getElementById("userProfileInformationForm-occupation");if(!e)return[];var t=[],r=e.value,e=document.getElementsByClassName(r),r=document.getElementsByClassName("occupation-field"),n=Array.from(e).map(function(e){return e.id}),o=_createForOfIteratorHelper(r);try{for(o.s();!(i=o.n()).done;){var i=i.value;n.includes(i.id)||t.push(i.id)}}catch(e){o.e(e)}finally{o.f()}return t}},{key:"updateChecklistItemCompletion",value:function(t,e){var r=this.checklist.findIndex(function(e){return e.label===t});this.checklist[r]=_objectSpread(_objectSpread({},this.checklist[r]),{},{isCompleted:e})}},{key:"updateUserPhotoCompletion",value:function(){var t,r,e,n=this;this.userPhoto&&(t=this.userPhoto.dataset.label,r=document.getElementById("checklist-photo"),(e=this.userPhoto.getAttribute("src")).includes("gravatar.com/avatar")?this.hasCustomGravatarImage(e).then(function(e){e&&(r.classList.add("completed"),n.updateChecklistItemCompletion(t,!0),n.updateCompletedPercentage())}):(r.classList.add("completed"),this.updateChecklistItemCompletion(t,!0),this.updateCompletedPercentage()))}},{key:"setupListeners",value:function(){var e=this;this.checklistTitle.onclick=function(){return e.checklistBox.classList.toggle("checklist-open")}}}]),e}();