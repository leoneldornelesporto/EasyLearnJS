"use strict";var PaymentFormHandler=function(t){var a={};return a.paymentForm=t,a.paymentFormValidator=new PaymentFormValidator(a.paymentForm),a.paypal=new Paypal(a.paymentForm),a.paypal.loadPPPFrame(),a.paymentForm.buttons.goToPaymentButton.on("click",function(t){var e=$(this);if("click"===t.type||(t.type="cpf"===e.attr("id")))if(a.paymentFormValidator.validateAllFields()){if(a.paymentForm.hasGoogleTagManager&&dataLayer.push({event:"informacoesOk"}),a.paymentForm.hasPaypalError)return a.paymentForm.buttons.stepSubmit.addClass("step-submit--disabled"),void a.paymentForm.goToComunicationFailure();a.paymentForm.buttons.stepSubmit.removeClass("step-submit--disabled"),$(".form-step-paypalFrame").addClass("form-step-paypalFrame--hidden"),a.paypal.loadPPPFrame(),setTimeout(function(){a.paymentForm.goToPaypalStep()},1e3)}else t.preventDefault(),a.paymentForm.buttons.stepSubmit.addClass("step-submit--disabled")}),a.paymentForm.buttons.completePayment.on("click",function(t){t.preventDefault(),a.paymentFormValidator.validateAllFields()?(a.savePurchaseAttempt(),a.paypal.getPPP().doContinue(),a.paymentForm.addLoadingToPaypalButton(),setTimeout(function(){a.paymentForm.removeLoadingFromPaypalButton()},1e4)):$(this).addClass("step-submit--disabled")}),a.paymentForm.buttons.stepLinkTryAgain.on("click",function(t){return"#"!==$(this).attr("href")||(t.preventDefault(),void a.paymentForm.goToBegin())}),a.savePurchaseAttempt=function(){var t;a.paymentForm.email()&&(t={paymentId:a.paymentForm.paymentId,buyerEmail:a.paymentForm.email(),buyerDocument:a.paymentForm.cpf(),buyerName:a.paymentForm.fullName(),buyerPhone:a.paymentForm.phone(),productId:a.paymentForm.productId,discountCode:a.paymentForm.discountCode,usernameIndicate:a.paymentForm.usernameIndicate,status:"CREATED"},$.post("/purchase/attempt/save",t))},a.paymentForm.inputs.cpf.on("input",function(){var t=$(this);$(this).val(t.val().replace(/\D/g,""))}),a.paymentForm.inputs.name.on("input",function(){$(".payment-paypalFrame").removeClass("form-paypal--active")}),a.paymentForm.inputs.isForeigner.on("change",function(){$(this).is(":checked")?($(".step-error-message").removeClass("step-error--visible"),a.paymentForm.inputs.cpf.removeClass("step-input--error"),a.paymentForm.inputs.cpf.val(""),a.paymentForm.inputs.cpf.prop("disabled",!0),a.paymentFormValidator.validateAllFields()&&a.paymentForm.buttons.goToPaymentButton.removeClass("step-submit--disabled")):($(".step-error-message").addClass("step-error--visible"),a.paymentForm.inputs.cpf.addClass("step-input--error"),a.paymentForm.buttons.goToPaymentButton.addClass("step-submit--disabled"),a.paymentForm.inputs.cpf.prop("disabled",!1))}),a.paymentForm.inputs.changeEmail.on("click",function(t){t.preventDefault(),a.paymentForm.inputs.email.prop("disabled",!1),$.get("/signout")}),a.paymentForm.inputs.name.focusout(a.savePurchaseAttempt),a.paymentForm.inputs.email.focusout(a.savePurchaseAttempt),a.paymentForm.inputs.cpf.focusout(a.savePurchaseAttempt),a.paymentForm.inputs.phone.focusout(a.savePurchaseAttempt),a.paymentForm.inputs.name.on("blur",a.paymentFormValidator.isValidName),a.paymentForm.inputs.email.on("blur",a.paymentFormValidator.isValidEmail),a.paymentForm.inputs.cpf.on("blur",a.paymentFormValidator.isValidCPF),{paymentForm:a.paymentForm}};