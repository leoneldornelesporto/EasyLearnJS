/*! ppplusbrcpmnodeweb 01-10-2021 */
define(["jquery","utility","installmentsHelper","rememberMeHelper","messageController","formValidation","domHelper","creditCardHelper","cache","resolutionHelper","cardDetails"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(c){e.hideErrorMessages(),a.ajax({type:"POST",url:"/inlinepaymentwall/payment-inline",data:c}).done(function(c){i.setSuccessfulTransaction(!0),b.postMessage("checkout",{result:c.results}),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton")}).fail(function(c){j.resolver(c.responseJSON.error),j.sendOnError(j.parseMsg(c,"error")),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton")})}function m(){var c=f.getData();a("#remember-card-box").is(":checked")&&c.payerIds.length>=3?(e.showWarningRememberCcLimit(),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton")):void 0!==c&&(d.isRememberMeCreditCardSelected()||"Generic"!==h.getCreditCardIcon()?l(c):(k.handleCreditCardType(),e.showTryAgain(),b.log("Credit Card type is unknown.","debug"),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton")))}function n(){a("#spinner").removeClass("hide"),b.postMessage("disableContinueButton");var c=h.getCardMetaData(),i=!1,j=d.retrieveSelectedRememberMePayerId();if(a("#remembered-cards")){if(a("#add-card-true").is(":checked"))i=f.validateIframe(null,c);else if(""===j&&0===d.getRememberedMeCards().length)i=f.validateIframe(null,c);else if(""!==j){var k=!0;a(g.cscRememberForm).hasClass("hide")||(k=f.isValidCSC(null,h.getCardMetaData(d.getSelectedRememberMeType())),k?a(g.cscRememberCc).parent().removeClass("notification"):a(g.cscRememberCc).parent().addClass("notification")),i=f.isValidInstallments(null)&&k}}else i=f.validateIframe(null,c);i?f.isPrivacyPolicyAgreed()?m():(e.showAgreePrivacyPolicy(),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton",{result:"error"})):(e.showWarnCompleteForm(),a("#spinner").addClass("hide"),b.postMessage("enableContinueButton",{result:"error"}))}return{doContinue:n}});