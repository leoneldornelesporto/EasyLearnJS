/*! ppplusbrcpmnodeweb 01-10-2021 */
define(["jquery","utility","cache","rememberMeHelper","installmentsHelper","domHelper","nameValidation","billingAddressValidation"],function(a,b,c,d,e,f,g,h){function i(b){a(b).addClass("select-error")}function j(b){a(b).removeClass("select-error")}function k(){i("#expiration-year-inline")}function l(){i("#expiration-month-inline")}function m(){j("#expiration-year-inline")}function n(){j("#expiration-month-inline")}function o(){i("#privacy-policy-box"),i("#privacy-policy-text")}function p(){j("#privacy-policy-box"),j("#privacy-policy-text")}return{isValidMonth:function(){return"MM"!==a("#expiration-month-inline").text().trim()?(n(),!0):(l(),!1)},isValidInstallments:function(){if(!a("#installmentDisabled").hasClass("hide"))return!0;var b=e.getSelectedInstallmentTerm(),c=a("#select-installments");return"NoSelection"===b?(c.addClass("select-error"),!1):(a("#single-installment").val(),c.removeClass("select-error"),!0)},isValidYear:function(){return/^[0-9]+$/.test(a("#expiration-year-inline").text().trim())?(m(),!0):(k(),!1)},isValidCreditCard:function(b,d){var e=a("#credit-card-inline"),f=!1,g=e.val().replace(/\s+/g,"").length;return("Generic"===d.type&&!c.failedRequests.creditcardtype||"Unsupported"===d.type)&&(f=!0),!f&&g>=d.minLength},isValidCSC:function(a,b){return f.getCsc().val().length===b.cvcLength},isValidName:function(){var a=g.isValidFirstName(),b=g.isValidLastName();return a&&b},isValidBillingAddress:function(){var a=h.isStreet1Entered(),b=h.isCityNameEntered(),c=h.isZipCodeEntered(),d=h.isStateChosen(),e=h.isCountryChosen();return a&&b&&c&&d&&e},isValidExpirationDate:function(){if(!this.isValidMonth()||!this.isValidYear())return!1;var b=parseInt(a("#expiration-year-inline").text().trim()),c=parseInt(a("#expiration-month-inline").text().trim()),d=new Date;return d.getFullYear()<b?(m(),!0):d.getFullYear()>b?(k(),!1):d.getMonth()+1>c?(l(),!1):(n(),m(),!0)},isPrivacyPolicyAgreed:function(){return!(a("#privacy-policy-box").length>0)||(1==a("#privacy-policy-box").is(":checked")?(p(),!0):(o(),!1))},disableCsc:function(){a(f.cscEntryCc).attr("disabled","disabled")},validateIframe:function(b,c){var d=c;return a("#credit-card-inline").on({blur:function(){a("#credit-card-inline").trigger("none")}}),a(f.cscEntries).on({blur:function(b){var c=a(b.target);a(c).trigger("none")}}),a("#credit-card-inline").trigger("none"),a(f.cscEntries).trigger("none"),!!(this.isValidName()&&this.isValidBillingAddress()&&this.isValidMonth(b)&&this.isValidYear(b)&&this.isValidInstallments(b)&&this.isValidCreditCard(b,d)&&this.isValidCSC(b,d)&&this.isValidExpirationDate())},getRememberedCardForCVV:function(){if(!a(f.cscRememberForm).hasClass("hide"))return a(f.cscRememberCc).val()},getData:function(){var b=d.retrieveSelectedRememberMePayerId();b=b.substring(7,b.length);var c=d.getRememberedMeCards(),g=e.getSelectedInstallmentTerm(),h={number:a("#credit-card-inline").val().replace(/\s+/g,""),type:document.getElementById("cardicon").className.replace("cardicon ",""),expire_month:document.getElementById("expiration-month-inline").textContent,expire_year:document.getElementById("expiration-year-inline").textContent,cvv2:a(f.cscEntryCc).val()},j={street1:a("#streetAddress1").val(),street2:a("#streetAddress2").val(),city:a("#city-name").val(),zip:a("#zip-code").val(),state:a("#state").val(),country:a("#country").val()},k={firstName:a("#first-name").val(),lastName:a("#last-name").val()},l=a("#remember-card-box").is(":checked"),m=a("#allow-marketing-box").is(":checked"),n="paypal",o=a("#turing").val();if(void 0!==g&&"NoSelection"===g)return void installments.addClass("select-error");var p=this.getRememberedCardForCVV();return""!==b||void 0!==h.number&&void 0!==h.type&&void 0!==h.expire_month&&void 0!==h.expire_year&&void 0!==h.cvv2?{payment_method:n,credit_card:h,rememberCard:l,isFixedInstallment:e.hasFixedInstallment(),allowMarketing:m,payerId:b,payerIds:c,termInfo:g,encryptedOM:o,billingAddress:j,payerName:k,cvvForRememberedCard:p}:void i("#credit-card-inline")}}});